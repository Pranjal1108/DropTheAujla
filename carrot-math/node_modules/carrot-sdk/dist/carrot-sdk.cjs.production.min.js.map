{"version":3,"file":"carrot-sdk.cjs.production.min.js","sources":["../src/constants.ts","../src/entities/fraction.ts","../src/entities/currency-amount.ts","../src/entities/currency.ts","../src/entities/kpi-token.ts"],"sourcesContent":["import FACTORY_ABI from './abis/factory.json'\nimport ERC20_ABI from './abis/erc20.json'\nimport REALITY_ABI from './abis/reality.json'\nimport KPI_TOKEN_ABI from './abis/kpi-token.json'\n\nexport const ZERO_ADDRESS = '0x0000000000000000000000000000000000000000'\n\nexport enum ChainId {\n  MAINNET = 1,\n  RINKEBY = 4,\n}\n\nexport const FACTORY_ADDRESS: { [chainId in ChainId]: string } = {\n  [ChainId.MAINNET]: ZERO_ADDRESS,\n  [ChainId.RINKEBY]: '0xa60c831dc30A6564Aa23044Ade594C2f1e3c9929',\n}\n\nexport const REALITY_ADDRESS: { [chainId in ChainId]: string } = {\n  [ChainId.MAINNET]: '0x325a2e0F3CCA2ddbaeBB4DfC38Df8D19ca165b47',\n  [ChainId.RINKEBY]: '0x3D00D77ee771405628a4bA4913175EcC095538da',\n}\n\nexport { FACTORY_ABI, REALITY_ABI, ERC20_ABI, KPI_TOKEN_ABI }\n","import invariant from 'tiny-invariant'\nimport { Decimal } from 'decimal.js-light'\nimport { BigNumber } from '@ethersproject/bignumber'\n\nexport class Fraction {\n  public readonly numerator: BigNumber\n  public readonly denominator: BigNumber\n\n  public constructor(numerator: BigNumber, denominator: BigNumber) {\n    this.numerator = numerator\n    this.denominator = denominator\n  }\n\n  public add(other: Fraction): Fraction {\n    if (this.denominator.eq(other.denominator)) {\n      return new Fraction(this.numerator.add(other.numerator), this.denominator)\n    }\n    return new Fraction(\n      this.numerator.mul(other.denominator).add(other.numerator.mul(this.denominator)),\n      this.denominator.mul(other.denominator)\n    )\n  }\n\n  public subtract(other: Fraction): Fraction {\n    if (this.denominator.eq(other.denominator)) {\n      return new Fraction(this.numerator.sub(other.numerator), this.denominator)\n    }\n    return new Fraction(\n      this.numerator.mul(other.denominator).sub(other.numerator.mul(this.denominator)),\n      this.denominator.mul(other.denominator)\n    )\n  }\n\n  public lessThan(other: Fraction): boolean {\n    return this.numerator.mul(other.denominator).lt(other.numerator.mul(this.denominator))\n  }\n\n  public equalTo(other: Fraction): boolean {\n    return this.numerator.mul(other.denominator).eq(other.numerator.mul(this.denominator))\n  }\n\n  public greaterThan(other: Fraction): boolean {\n    return this.numerator.mul(other.denominator).gt(other.numerator.mul(this.denominator))\n  }\n\n  public isZero(): boolean {\n    return this.numerator.eq(0)\n  }\n\n  public multiply(other: Fraction): Fraction {\n    return new Fraction(this.numerator.mul(other.numerator), this.denominator.mul(other.denominator))\n  }\n\n  public divide(other: Fraction): Fraction {\n    return new Fraction(this.numerator.mul(other.denominator), this.denominator.mul(other.numerator))\n  }\n\n  public toFixed(decimalPlaces: number): string {\n    invariant(Number.isInteger(decimalPlaces), `${decimalPlaces} is not an integer.`)\n    invariant(decimalPlaces >= 0, `${decimalPlaces} is negative.`)\n    return new Decimal(this.numerator.toString()).dividedBy(this.denominator.toString()).toFixed(decimalPlaces)\n  }\n}\n","import { Currency, Token } from './currency'\nimport invariant from 'tiny-invariant'\nimport { BigNumber } from '@ethersproject/bignumber'\nimport { Fraction } from './fraction'\n\nexport class CurrencyAmount extends Fraction {\n  public readonly currency: Currency\n\n  public constructor(currency: Currency, amount: BigNumber | Fraction) {\n    if (amount instanceof Fraction) {\n      super(amount.numerator, amount.denominator)\n    } else {\n      super(amount, BigNumber.from(10).pow(currency.decimals))\n    }\n    this.currency = currency\n  }\n\n  public plus(other: CurrencyAmount): CurrencyAmount {\n    invariant(this.currency.equals(other.currency), 'tried to sum different currencies')\n    return new CurrencyAmount(this.currency, super.add(other))\n  }\n\n  public minus(other: CurrencyAmount): CurrencyAmount {\n    invariant(this.currency.equals(other.currency), 'tried to subtract different currencies')\n    return new CurrencyAmount(this.currency, super.subtract(other))\n  }\n\n  public multiply(other: CurrencyAmount): CurrencyAmount {\n    return new CurrencyAmount(other.currency, super.multiply(other))\n  }\n}\n\nexport class TokenAmount extends CurrencyAmount {\n  public readonly token: Token\n\n  public constructor(token: Token, amount: BigNumber | Fraction) {\n    super(token, amount)\n    this.token = token\n  }\n}\n","import { getAddress, isAddress } from '@ethersproject/address'\nimport { BigNumber } from '@ethersproject/bignumber'\nimport { ChainId } from '../constants'\nimport invariant from 'tiny-invariant'\n\nexport class Currency {\n  public readonly decimals: BigNumber\n  public readonly symbol: string\n  public readonly name: string\n\n  public static ETHER = new Currency(BigNumber.from(18), 'ETH', 'Ether')\n\n  public constructor(decimals: BigNumber, symbol: string, name: string) {\n    this.decimals = decimals\n    this.symbol = symbol\n    this.name = name\n  }\n\n  public static getNative(chainId: ChainId): Currency {\n    switch (chainId) {\n      case ChainId.RINKEBY:\n      case ChainId.MAINNET: {\n        return Currency.ETHER\n      }\n      default: {\n        invariant(false, 'not a valid chain id when getting native currency')\n      }\n    }\n  }\n\n  public equals(other: Currency): boolean {\n    if (this instanceof Token && other instanceof Token) {\n      return this.equals(other)\n    }\n    return this === other\n  }\n}\n\nexport class Token extends Currency {\n  public readonly chainId: ChainId\n  public readonly address: string\n\n  public constructor(chainId: ChainId, address: string, decimals: BigNumber, symbol: string, name: string) {\n    super(decimals, symbol, name)\n    this.chainId = chainId\n    invariant(isAddress(address), `${address} is not a valid address`)\n    this.address = getAddress(address)\n  }\n\n  public equals(other: Token): boolean {\n    if (this === other) {\n      return true\n    }\n    return this.chainId === other.chainId && this.address === other.address\n  }\n}\n","import { ChainId } from '../constants'\nimport { TokenAmount } from './currency-amount'\nimport invariant from 'tiny-invariant'\nimport { Token } from './currency'\nimport { BigNumber } from '@ethersproject/bignumber'\nimport { DateTime } from 'luxon'\nimport Decimal from 'decimal.js-light'\n\nexport class KpiToken extends Token {\n  public readonly kpiId: string\n  public readonly totalSupply: TokenAmount\n  public readonly oracle: string\n  public readonly question: string\n  public readonly lowerBound: BigNumber\n  public readonly higherBound: BigNumber\n  public readonly finalProgress: BigNumber\n  public readonly expiresAt: DateTime\n  public readonly finalized: boolean\n  public readonly kpiReached: boolean\n  public readonly creator: string\n  public readonly collateral: TokenAmount\n  public readonly fee: TokenAmount\n\n  constructor(\n    chainId: ChainId,\n    address: string,\n    symbol: string,\n    name: string,\n    kpiId: string,\n    totalSupply: BigNumber,\n    oracle: string,\n    question: string,\n    lowerBound: BigNumber,\n    higherBound: BigNumber,\n    finalProgress: BigNumber,\n    expiresAt: DateTime,\n    finalized: boolean,\n    kpiReached: boolean,\n    creator: string,\n    collateral: TokenAmount,\n    fee: TokenAmount\n  ) {\n    super(chainId, address, BigNumber.from('18'), symbol, name)\n    invariant(collateral.token.chainId === chainId, 'inconsistent chain id in collateral')\n    invariant(fee.token.equals(collateral.token), 'inconsistent collateral and fee token')\n    invariant(fee.token.chainId === chainId, 'inconsistent chain id in collateral')\n    invariant(lowerBound.lt(higherBound), 'inconsistent scalar bounds')\n    this.kpiId = kpiId\n    this.totalSupply = new TokenAmount(this, totalSupply)\n    this.oracle = oracle\n    this.question = question\n    this.lowerBound = lowerBound\n    this.higherBound = higherBound\n    this.finalProgress = finalProgress\n    this.expiresAt = expiresAt\n    this.finalized = finalized\n    this.kpiReached = kpiReached\n    this.creator = creator\n    this.collateral = collateral\n    this.fee = fee\n  }\n\n  public get progressPercentage(): Decimal {\n    const kpiScalarRange = this.higherBound.sub(this.lowerBound)\n    return new Decimal(this.finalProgress.toString()).dividedBy(kpiScalarRange.toString()).times(100)\n  }\n}\n"],"names":["ChainId","Fraction","numerator","denominator","add","other","this","eq","mul","subtract","sub","lessThan","lt","equalTo","greaterThan","gt","isZero","multiply","divide","toFixed","decimalPlaces","Number","isInteger","invariant","Decimal","toString","dividedBy","CurrencyAmount","currency","amount","BigNumber","from","pow","decimals","plus","equals","minus","TokenAmount","token","ZERO_ADDRESS","FACTORY_ADDRESS","MAINNET","RINKEBY","REALITY_ADDRESS","Currency","symbol","name","getNative","chainId","ETHER","Token","address","isAddress","getAddress","KpiToken","kpiId","totalSupply","oracle","question","lowerBound","higherBound","finalProgress","expiresAt","finalized","kpiReached","creator","collateral","fee","kpiScalarRange","times"],"mappings":"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"}